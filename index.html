<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hello World App</title>
  <link rel="manifest" href="manifest.json">
</head>

<body>
  <h1>Hello, World!</h1>
  <p>This is a simple PWA example.</p>
  <!-- Add to Home Screen Button -->
  <button id="openInChromeBtn" style="display: none;">Open in Chrome</button>

  <button id="install-button" style="display: none;">Add to Home Screen</button>

  <script>
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('install-button').style.display = 'block';
    });

    document.getElementById('install-button').addEventListener('click', () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            console.log('User accepted the A2HS prompt');
          } else {
            console.log('User dismissed the A2HS prompt');
          }
          deferredPrompt = null;
        });
      }
    });
 // document.getElementById("openInChromeBtn").addEventListener("click", function () {
 //      // Chrome မှာ ဖွင့်ချင်တဲ့ URL
 //      const targetURL = "https://pyaephyoaung98.github.io/pws/";
 //      // Android Chrome Package အတွက် Intent URL
 //      const chromeIntentUrl = `intent://pyaephyoaung98.github.io/pws/#Intent;scheme=https;package=com.android.chrome;end`;

 //      // ၁) intent:// URL ကို ထုတ်ပစ်သွားမယ်
 //      window.location.replace(chromeIntentUrl);

 //      // ၂) setTimeout နဲ့ Fallback ပြုလုပ်
 //      // အချို့ Browser တွေမှာ intent:// မဖွင့်နိုင်တဲ့အခါ 
 //      // seconds ခုဆိုပြီး normal URL ကို ပြန်ဖွင့်အောင်လုပ်ထားမယ်
 //      setTimeout(function () {
 //        window.location.replace(targetURL);
 //      }, 2000);
 //    });

    function isInAppBrowser() {
      const userAgent = navigator.userAgent || navigator.vendor || window.opera;

      // Examples of known in-app browser UA substrings:
      // - "FBAN" or "FBAV" for Facebook
      // - "Instagram" for Instagram
      // - "Line" for LINE
      // - "Messenger" for FB Messenger
      // - "Telegram" for Telegram (some variations)

      const inAppBrowserRegex = /FBAN|FBAV|Instagram|Line|Messenger|Telegram/i;
      return inAppBrowserRegex.test(userAgent);
    }

    // 2. Show/Hide "Open in Chrome" button based on detection
    function toggleOpenInChromeButton() {
      const openInChromeBtn = document.getElementById("openInChromeBtn");

      if (isInAppBrowser()) {
        // Show the button if in an in-app browser
        openInChromeBtn.style.display = "inline-block";

        // Add click event to open the link in Chrome (on Android)
        openInChromeBtn.addEventListener("click", function () {
          // The URL you want to open
          const targetURL = "https://pyaephyoaung98.github.io/pws/";
          // Android Chrome intent scheme
          const chromeIntentUrl = `intent://https://pyaephyoaung98.github.io/pws/#Intent;scheme=https;package=com.android.chrome;end`;

          // Attempt to open via intent://
          window.location.replace(chromeIntentUrl);

          // Fallback after 2 seconds if it fails
          setTimeout(() => {
            window.location.replace(targetURL);
          }, 2000);
        });
      } else {
        // Hide the button if not in an in-app browser
        openInChromeBtn.style.display = "none";
      }
    }

    // 3. Run the function on page load
    document.addEventListener("DOMContentLoaded", toggleOpenInChromeButton);

  </script>
</body>

</html>
